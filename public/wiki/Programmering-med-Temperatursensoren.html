<!DOCTYPE html>
<html lang="nb-NO" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" charset="utf-8" />
    <title>Programmering med Temperatursensoren &ndash; air:bit Wiki</title>

    <!-- Boots -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
        crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js" integrity="sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk="
        crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
        crossorigin="anonymous"></script>
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js'></script>
    <!-- Leaflet -->
    <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />
    <!-- d3 -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-93186535-1', 'auto');
        ga('send', 'pageview');</script>
    <link rel="stylesheet" href="public/css/style.css" />
    <script src="public/js/vis.js"></script>
</head>
<body>
    <nav class="navbar navbar-toggleable-md navbar-light bg-faded">
        <button class="navbar-toggler navbar-toggler-right custom-toggler" type="button" data-toggle="collapse" data-target="#navbar"
            aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand" href="github_pages">air:bit</a>
        <div class="collapse navbar-collapse" id="navbar">
            <ul class="navbar-nav mr-auto"></ul>
            <ul class="navbar-nav my-2 my-lg-0">
                <li class="nav-item">
                    <!-- <a class="nav-link" target="_blank" href="https://luft-184208.appspot.com/">Last opp data<span class="sr-only">(current)</span></a> -->
                    <a class="nav-link" href="upload">Last opp data</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="history">Søk i tid</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="live">Live</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="main">
        <div class="container container-fluid">
            <div class="row">
                <div class="col-xs-12 col-sm-9 col-sm-pull-3">
                    <div class="markdown">
                        <h1>Programmering med Temperatursensoren</h1>
                        <hr />
                        <p>Av alle sensorene til air:bit er temperatursensoren den enkleste. Temperatursensoren vi bruker i air:bit, DHT, er en veldig vanlig type sensor. Heldigvis betyr dette for oss at noen andre allerede har gjort jobben med å finne ut hvordan man leser av data fra sensoren. Dette gjør det veldig mye enklere å lese av temperaturdata.</p>
<p>Vi kommer til å skrive en veldig enkel Arduino Sketch, der vi skriver ut temperatur og fuktighetsmålinger over en seriell forbindelse.</p>
<h2 id="komme-i-gang">Komme i gang</h2>
<p>Igjen vil vi starte med en helt fersk tom Sketch. Du kan klikke på <code>File</code>&rarr;<code>New</code> menyen for å starte en ny Sketch.</p>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{

}
</code></pre>
<h3 id="installere-dht-sensor-library-biblioteket">Installere <code>DHT sensor library</code> biblioteket<a class="wiki-helplink" href="mailto:skolelaboratoriet@nt.uit.no?subject=%5Bairbit%5D%20-%20Hjelp%21%20%7C%20Programmering%20med%20Temperatursensoren%20-%20Installere%20%60DHT%20sensor%20library%60%20biblioteket&body=Hjelp%20jeg%20sitter%20fast%21%0D%0AJeg%20leser%20f%C3%B8lgende%20side%3A%20http%3A%2F%2Fairbit.uit.no%2Fpublic%2Fwiki%2FProgrammering-med-Temperatursensoren.html%23installere-dht-sensor-library-biblioteket">
    Hjelp meg! skolelaboratoriet@nt.uit.no
</a></h3>
<p>Før vi begynner må vi laste ned og installere et Arduino bibliotek. Tidligere har vi brukt kommandoer som <code>delay</code>, <code>pinMode</code> og <code>digitalWrite</code> som alle er del av standard-biblioteket for Arduino. Vi trenger nye kommandoer for å lese av temperatur fra DHT-sensoren. Disse vil vi finne i et bibliotek som heter <code>DHT sensor library</code> som er laget av selskapet Adafruit. <em>Adafruit er en av de største produsentene for Arduino-utstyr.</em></p>
<p><code>Arduino IDE</code> har en innebygd meny for å laste ned Arduino bibliotek. Klikk på <code>Sketch</code>&rarr;<code>Include library</code>&rarr;<code>Manage libraries...</code> for å åpne <code>Library Manager</code>.</p>
<p><img src="Arduino-IDE-Manage-Library.png" alt="Arduino IDE Manage libraries"/></p>
<p>I <code>Library Manager</code> som åpner seg, må du nå søke for <code>DHT sensor library</code> som er biblioteket for sensoren DHT i air:bit. Skriv inn <code>DHT sensor library</code> i søkefeltet. Klikk på resultatet som kommer opp, velg den nyeste versjonen i Drop-Down-menyen og klikk på <code>Install</code>.</p>
<p><img src="Arduino-IDE-Library-Manager-DHTSensorLibrary.png" alt="Arduino IDE Library Manager: DHT sensor library"/></p>
<h3 id="installere-adafruit_sensor-biblioteket">Installere <code>Adafruit_Sensor</code> biblioteket<a class="wiki-helplink" href="mailto:skolelaboratoriet@nt.uit.no?subject=%5Bairbit%5D%20-%20Hjelp%21%20%7C%20Programmering%20med%20Temperatursensoren%20-%20Installere%20%60Adafruit_Sensor%60%20biblioteket&body=Hjelp%20jeg%20sitter%20fast%21%0D%0AJeg%20leser%20f%C3%B8lgende%20side%3A%20http%3A%2F%2Fairbit.uit.no%2Fpublic%2Fwiki%2FProgrammering-med-Temperatursensoren.html%23installere-adafruit_sensor-biblioteket">
    Hjelp meg! skolelaboratoriet@nt.uit.no
</a></h3>
<p><code>DHT sensor library</code>-biblioteket bruker Adafruit sitt overordnete <code>Adafruit_Sensor</code> bibliotek. Dette inneholder informasjon som er til felles for alle Adafruit sine sensorer.</p>
<p>For å installere dette biblioteket skal vi laste ned nyeste version selv ved å klikke på denne linken: <a href="https://github.com/adafruit/Adafruit_Sensor/releases/latest"><strong>Adafruit_Sensor</strong></a><br/>Klikk på linken <strong>Source code</strong> (zip) for å laste ned biblioteket.<br/>Det er viktig at du lagrer (<strong>ikke åpner</strong>) filen. Husk hvor du lagrer filen, vi må finne frem den filen i neste steg.</p>
<p><img src="GitHub-Adafruit_Sensor-download.png" alt="Download Adafruit_Sensor library"/></p>
<p>Etter du har lastet ned biblioteket og lagret filen må vi installere biblioteket i <code>Arduino IDE</code>. Klikk i menyen på <code>Sketch</code>&rarr;<code>Include library</code>&rarr;<code>Add ZIP library</code> (punktet under <code>Manage libraries</code>). Velg filen du nettopp lastet ned. Om nettleseren din ikke ba deg om å velge hvor filen skulle lagres, vil du mest sannsynligvis finne den under <code>Downloads</code> (<code>Nedlastinger</code>).</p>
<h2 id="globale-definisjoner">Globale definisjoner<a class="wiki-helplink" href="mailto:skolelaboratoriet@nt.uit.no?subject=%5Bairbit%5D%20-%20Hjelp%21%20%7C%20Programmering%20med%20Temperatursensoren%20-%20Globale%20definisjoner&body=Hjelp%20jeg%20sitter%20fast%21%0D%0AJeg%20leser%20f%C3%B8lgende%20side%3A%20http%3A%2F%2Fairbit.uit.no%2Fpublic%2Fwiki%2FProgrammering-med-Temperatursensoren.html%23globale-definisjoner">
    Hjelp meg! skolelaboratoriet@nt.uit.no
</a></h2>
<p>Først må <code>DHT</code>-biblioteket inkluderes i Arduino-Sketchen. I <code>C++</code> bruker vi <code>#include</code> direktivet for dette:</p>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;DHT.h&gt;</span></span>
</code></pre>
<p>Så ta en titt på <a href="airbit-Pinout.html">Pinout Skjemaet</a>. Definér en konstant for pinnen for Temperatursensoren:</p>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DHTPIN 9</span>
</code></pre>
<p>Tidligere i <a href="Variabler-og-telling-i-Arduino.html">eksempelet for telling</a> deklarerte du en variabel med datatype <code>int</code>. Nå må du deklarere en variabel for å kontrollere forbindelsen med DHT sensoren. Datatypen for dette kommer fra det inkluderte <code>DHT</code> biblioteket og heter <code>DHT</code>. For å deklarere denne variabelen trenger du to ting: hvilken pinne den er koblet til på, og hvilken slags type DHT du bruker.</p>
<p>Pinnen har du allere definiert i <code>DHTPIN</code> konstanten i linjen over, og i vårt tilfelle bruker vi en DHT-sensor type <code>DHT22</code>.</p>
<pre><code class="lang-cpp"><span class="hljs-function">DHT <span class="hljs-title">dhtSensor</span><span class="hljs-params">(DHTPIN, DHT22)</span></span>;
</code></pre>
<p><em>I koden over kalles variabelen <code>dhtSensor</code>, men du kan bruke hvilket som helst navn som du har lyst å bruke. Det anbefales å bruke et deskriptivt navn som virker intuitivt å bruke. Merk også at vi bruker konstanten <code>DHT22</code>. Fra beskrivelsen som vistes når du installerte DHT-biblioteket kan du se at det finnes flere varianter av DHT-sensorer. air:bit sin sensor er av den nyere <code>DHT22</code> varianten.</em></p>
<h2 id="-setup-"><code>setup</code><a class="wiki-helplink" href="mailto:skolelaboratoriet@nt.uit.no?subject=%5Bairbit%5D%20-%20Hjelp%21%20%7C%20Programmering%20med%20Temperatursensoren%20-%20%60setup%60&body=Hjelp%20jeg%20sitter%20fast%21%0D%0AJeg%20leser%20f%C3%B8lgende%20side%3A%20http%3A%2F%2Fairbit.uit.no%2Fpublic%2Fwiki%2FProgrammering-med-Temperatursensoren.html%23-setup-">
    Hjelp meg! skolelaboratoriet@nt.uit.no
</a></h2>
<p>For dette eksemplet for programmering med DHT sensoren skal vi bruke en seriell forbindelse med PC&#39;en, så vi må initialisere den serielle forbindelsen, slik vi har gjort tidligere.</p>
<pre><code class="lang-cpp">  Serial.begin(<span class="hljs-number">9600</span>);
</code></pre>
<h2 id="-loop-"><code>loop</code><a class="wiki-helplink" href="mailto:skolelaboratoriet@nt.uit.no?subject=%5Bairbit%5D%20-%20Hjelp%21%20%7C%20Programmering%20med%20Temperatursensoren%20-%20%60loop%60&body=Hjelp%20jeg%20sitter%20fast%21%0D%0AJeg%20leser%20f%C3%B8lgende%20side%3A%20http%3A%2F%2Fairbit.uit.no%2Fpublic%2Fwiki%2FProgrammering-med-Temperatursensoren.html%23-loop-">
    Hjelp meg! skolelaboratoriet@nt.uit.no
</a></h2>
<p>For hver gjennomgang gjennom <code>loop</code>-funksjonen skal vi lese ut måleverdiene fra sensoren, så skrive dem ut over seriell-forbindelsen. Til slutt skal vi vente en stund til vi tar neste måling.</p>
<p>For å starte med trenger vi to lokale variabler for å lagre måleverdiene (en for temperatur og en for fuktighet). Lokale variabler deklareres akkurat som globale variabler (som f.eks. <code>dhtSensor</code>), men de varer bare for én gjennomgang gjennom <code>loop</code>-funksjonen, dvs. variabelen lages på nytt for hver gjennomgang. Variabler for å lagre en måling fra sensorer lages best som lokale variabler i stedet for globale variabler.</p>
<p>Temperatur og Fuktighet er verdier som representeres som kommatall. F.eks. et vanlig digitalt termometer vil vise temperatur som f.eks. <code>20.7°C</code>. Fuktighet måles som relativ fuktighet i %, f.eks. <code>41.2% RH</code>. Variabler for å lagre kommatall må bruke datatypen <code>float</code>. <em><code>float</code> er en forkortelse for <code>floating-point decimal number</code> og det er slik en datamaskin vanligvis håndterer kommatall.</em></p>
<pre><code class="lang-cpp">  <span class="hljs-keyword">float</span> temperature = <span class="hljs-number">0.0</span>;
  <span class="hljs-keyword">float</span> humidity = <span class="hljs-number">0.0</span>;
</code></pre>
<p>I koden over ser du at variabler også kan initialiseres samtidig med deklarasjonen. Merk at kommatall bruker <code>.</code> (punktum) som komma-tegn. <em>Igjen, merk at variablene kan navngis hvordan som helst.</em></p>
<p>Nå kan vi bruke <code>readTemperature</code> og <code>readHumidity</code> kommandoene som hører til <code>dhtSensor</code> variabelen vår. Resultatene vil bli gitt i hhv. grader Celsius (<code>°C</code>) og <code>%</code> relativ fuktighet.</p>
<pre><code class="lang-cpp">  temperature = dhtSensor.readTemperature();
  humidity = dhtSensor.readHumidity();
</code></pre>
<p>Etter disse kommandoene vil den aktuelle verdien for temperatur og fuktighet være lagret i variablene, så vi kan skrive dem ut.</p>
<pre><code class="lang-cpp">  Serial.print(temperature);
  Serial.print(<span class="hljs-string">"°C"</span>);
  Serial.print(<span class="hljs-string">"\t"</span>);
  Serial.print(humidity);
  Serial.print(<span class="hljs-string">"%"</span>);
  Serial.println();
</code></pre>
<p>I den tredje linjen over ser du at <code>\t</code> skrives ut. I <code>C++</code> brukes <code>\</code> (backslash) for spesielle tegn. <code>\t</code> er et spesiellt tegn kalt tabulator. Det brukes for å skille kolonner i en tabell fra hverandre. I et vanlig tekst-program, som f.eks. Word, vil du skrive et tabulator-symbol ved å trykke Tab-tasten til venstre for <code>Q</code> på det norske tastaturet.</p>
<p>Helt til slutt vil vi vente en liten stund til det leses av en ny måling. Bruk <code>delay</code>-kommandoen for dette.</p>
<pre><code class="lang-cpp">  delay(<span class="hljs-number">1500</span>);
</code></pre>
<h2 id="ferdig">Ferdig</h2>
<p>Siden variabler kan navngis som du ønsker kan koden din se litt anderledes ut, men hovedsakelig burde ting se ut som vist under.</p>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;DHT.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DHTPIN 9</span>
<span class="hljs-function">DHT <span class="hljs-title">dht22</span><span class="hljs-params">(DHTPIN, DHT22)</span></span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
  Serial.begin(<span class="hljs-number">9600</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// Declare variables for sensor readings</span>
  <span class="hljs-keyword">float</span> temperature = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">float</span> humidity = <span class="hljs-number">0</span>;
  <span class="hljs-comment">// Take readings from sensor</span>
  temperature = dht22.readTemperature();
  humidity = dht22.readHumidity();

  <span class="hljs-comment">// Print out readings</span>
  Serial.print(temperature);
  Serial.print(<span class="hljs-string">"°C"</span>);
  Serial.print(<span class="hljs-string">"\t"</span>);
  Serial.print(humidity);
  Serial.print(<span class="hljs-string">"%"</span>);
  Serial.println();

  <span class="hljs-comment">// Wait 2.5 seconds until next reading.</span>
  delay(<span class="hljs-number">2500</span>);
}
</code></pre>
<h2 id="g-videre">Gå videre</h2>
<p>&uarr; <a href="airbit-Programmering.html">Gå til <strong>innholdsfortegnelsen</strong></a><br/>&larr; <a href="airbit-LED-Blinking.html">Gå tilbake forrige neste steg: <strong>LED</strong></a><br/>&rarr; <a href="Programmering-med-Støvsensoren.html">Gå til neste steg: <strong>Støvsensoren</strong></a>  </p>

                    </div>
                </div>
                <div class="col-xs-12 col-sm-3 col-sm-push-9 well">
                    <h1 id="meny">Meny</h1>
<ul>
<li><a href="Home.html">Hjem</a></li>
<li><a href="airbit-Guider.html">Guider</a><ul>
<li><a href="Guide-Bygging-og-Lodding.html">Bygging og Lodding</a></li>
<li><a href="Guide-Oppsett-for-programmering.html">Oppsett av programmvare</a></li>
<li><a href="Introduksjon-til-Arduino-programmering.html">Arduino programmering</a></li>
<li><a href="airbit-Programmering.html">air:bit programmering</a></li>
<li><a href="Feilsøking-av-programmeringsfeil.html">Feilsøking</a></li>
</ul>
</li>
<li><a href="airbit-Pinout.html">Pinout</a></li>
<li><a href="Dataformat.html">Dataformat</a></li>
</ul>

                </div>
            </div>
        </div>
    </div>
    <footer id="footer" class="footer"></footer>
</body>
</html>